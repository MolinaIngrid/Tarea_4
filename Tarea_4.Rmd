---
title: "Tarea 4"
author: "Ingrid Molina, Minor Solano & Raquel Bone"
date: "16/11/2020"
output: 
 prettydoc::html_pretty:
    theme: Cayman
    highlight: vignette
vignette: >
  %\VignetteIndexEntry{Creating Pretty Documents from R Markdown - The Cayman Theme}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

En un periodo de 10 años (A) Nuestro equipo trabajó en 60 poblaciones (P) de *P. pajaritus* desde Canadá hasta Ecuador. En cada población tomamos una muestra de sangre de 10 individuos de la que extrajimos ADN genómico y amplificamos y secuenciamos los genes CMH-I para obtener el número de alelos por individuo.

Además cuantificamos 5 variables que son indicadoras de la degradación del hábitat (H) y obtuvimos las coordenadas geográficas (L) para cada población.

Nuestra **pregunta** es cómo se ve afectada la complejidad alélica (D) de *P. pajaritus* debido a la degradación del hábitat.

``` {r, echo=FALSE}
Datos <- read.table("C:/Users/raque/Desktop/Ciencia_rep/Tarea_4/Datos_tarea4.csv", header = TRUE, sep = ",")

```

```{r load-packages, include=FALSE}
library(ggplot2)
library(GGally)
```

### Explorando los datos 

Hacemos un gráfico para observar visualmente las relaciones entre las variables predictoras y la variable respuesta

``` {r}

ggpairs(Datos, lower = list(continuous = "smooth"),
        diag = list(continuous = "barDiag"), axisLabels = "none")

```

Las variables que tienen una mayor relación lineal con la Diversidad alélica son: H4 (r= -0.66), Latitud (r= 0.334) y H1 (r= 0.304).


## 1. Modelo lineal con todos los predictores

``` {r}

regresion <- lm(D~H1+H2+H3+H4+H5+P+L, data = Datos)

summary(regresion)

```


El modelo con todas las variables introducidas como predictores tiene un R2 de casi 0.5 (0.496), es capaz de explicar el 50% de la variabilidad observada en la Diversidad alélica. El p-value del modelo es significativo (2.2e-16).  Muchos de los coeficientes parciales de regresión no son significativos, lo que es un indicativo de que podrían no contribuir al modelo.

### Selección del mejor modelo
Iniciando el modelo con todas las variables como predictores y realizando la selección de los mejores predictores con la medición Akaike(AIC).


```{r}
step(object = regresion, direction = "both", trace = 1)
```


El mejor modelo resultante del proceso de selección ha sido:
lm(formula = D ~ H1 + H2 + H4 + H5 + P + L, data = Datos)
Le llamaremos modelo1


```{r}

modelo1 <- lm(formula = D ~ H1 + H2 + H4 + H5 + P + L, data = Datos)

summary(modelo1)

```

### Interpretación del modelo

Por cada unidad que aumenta el predictor H1, la Diversidad alélica disminuye en promedio 1.9 unidades, manteniéndose constantes el resto de predictores.

Por cada unidad que aumenta el predictor H2, la Diversidad alélica disminuye en promedio 1.7 unidades, manteniéndose constantes el resto de predictores.

Por cada unidad que aumenta el predictor H4, la Diversidad alélica disminuye en promedio 6 unidades, manteniéndose constantes el resto de predictores.

Por cada unidad que aumenta el predictor H5, la Diversidad alélica aumenta en promedio 6 unidades, manteniéndose constantes el resto de predictores.

Por cada unidad que aumenta la Latitud, la Diversidad alélica disminuye en promedio 0.4 unidades, manteniéndose constantes el resto de predictores.

Creemos que sería más eficiente utilizar únicamente una variable, H4, como proxy de la destrucción del hábitat en lugar de 5 variables como indicadoras de esa destrucción... Pero para asegurarnos de que efectivamente es la variable adecuada proponemos:

## 2. Modelos para cada una de las variables de degradación de hábitat (H)

Dado que tenemos cinco variables distintas para medir la degradación del hábitat, probamos hacer un modelo para cada una de estas variables por aparte, para evaluar si tienen un efecto distinto sobre la diversidad alélica de *P. pajaritus* y poder elegir la que tiene un mayor efecto.

```{r}

# Modelo lineal con H1
m1 <- lm(D ~ H1 + P + L, Datos)
summary(m1)

# Modelo lineal con H2
m2 <- lm(D ~ H2 + P + L, Datos)
summary(m2)

# Modelo lineal con H3
m3 <- lm(D ~ H3 + P + L, Datos)
summary(m3)

# Modelo lineal con H4
m4 <- lm(D ~ H4 + P + L, Datos)
summary(m4)

# Modelo lineal con H5
m5 <- lm(D ~ H5 + P + L, Datos)
summary(m5)

```

### Interpretación de los modelos

Obtuvimos que H1 y H4 son las mejores candidatas para representar la degradación del hábitat en nuestro mejor modelo. 
En el modelo m1, donde incluimos H1, observamos un efecto significativo de esta variable, donde por cada unidad que aumente H1, la diversidad alélica disminuye en promedio 2 unidades. Además, observamos un efecto significativo del efecto latitudinal, donde por cada unidad que aumentemos en latitud, la D disminuye en promedio 3.4 unidades, también se observa también un leve efecto significativo de cada población de *P. pajaritus* (estimado = 0.16).

Mientras que con el modelo m4, donde evaluamos a H4, obtuvimos un mayor efecto de la variable, pues por cada unidad que aumente H4, la diversidad alélica disminuye en promedio 6 unidades. No obstante, en este modelo no observamos un efecto significativo de las poblaciones de *P. pajaritus*, y a pesar de que se mantiene un efecto de la latitud, éste es menos marcado, ya que por cada unidad que aumente, se disminuye en promedio 1 unidad de diversidad alélica.

Dadas estas diferencias observadas entre las variables H, y el dilema entre las variables H4 y H1, sugerimos probar si excluyendo alguna (s) poblacion (es) de *P. pajaritus* podamos evaluar si al hacer estas variaciones observemos un efecto significativo de la variable población (P) en el modelo lineal con H4.

## 3. 



**Información de la sesión**

```{r, echo=FALSE}
sessionInfo()
```